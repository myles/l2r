head	1.2;
access;
symbols;
locks
	drew:1.2; strict;
comment	@# @;


1.2
date	2001.08.08.20.24.25;	author drew;	state Exp;
branches;
next	1.1;

1.1
date	2001.08.02.20.20.08;	author drew;	state Exp;
branches;
next	;


desc
@@


1.2
log
@*** empty log message ***
@
text
@#!/usr/bin/perl 

unless (caller() ) {
	test();
}

sub wireless {

	my $if = shift;
#	print "$if\n";
# Remove this when real wireless interfaces happen
	return 1;

	open (IF,"/sbin/iwconfig $if | ");
	$xix=<IF>;
	if ($xix=~/no wireless extensions/) {
		return 0;
	}
	return 1;
}


sub discover {
	my %if_list=();
	my($ip, $interface);

	open(IF,"/sbin/ifconfig | ");

	while (<IF>) {
		if ($_ =~ /Link encap:/) {
			($interface,$garbage)= split(/ /,$_,2);
		}elsif ($_ =~ /inet addr:/) {
			($trash,$ip,$bip,$garbage)=split(/:/,$_);
			if ( wireless($interface) ){
				($ip,$trash) =split(/ /,$bip);
				$if_list{$interface}=$ip unless $interface eq "lo";
			}
			$interface="";
		} else {
			next;
		}
	}
	return %if_list;
}


sub test {
	# Test script

	%x=discover();
	foreach $i (keys(%x) ) {
		print "$i = $x{$i}\n";
	}

}

1;
@


1.1
log
@Initial revision
@
text
@d3 18
a20 1
sub discover {
d23 1
d25 1
a25 1
	my $ip, interface;
d30 1
a30 1
		if ($_=~ /Link encap:/) {
d32 1
a32 1
		}elsif ($_=~ /inet addr:/) {
d34 4
a37 2
			($ip,$trash) =split(/ /,$bip);
			$if_list{$interface}=$ip unless $interface eq "lo";
a45 1
1;
d47 2
a48 1
# Test script
d50 4
a53 1
#%x=discover();
d55 1
a55 3
#foreach $i (keys(%x) ) {
#	print "$i = $x{$i}\n";
#}
d57 1
@
